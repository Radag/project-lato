{block content}
{control topPanel}
<section class="main" id="message-detail">
    <script src="/js/ckeditor/ckeditor.js"></script>
    <div class="container offset-1">
        <div class="row">
            <div class="col s12" n:snippet="conversation-list">
                <div class="conversation">
                    {foreach $messages as $message}
                    <div class="message {if !$message->fromMe}me{else}from{/if}">
                        <div class="card bubble paper-shadow">
                            <div class="card-header">
                                <h3 class="name truncate">
                                    <a href="{$message->user->slug}">{$message->user->name} {$message->user->surname}</a>
                                </h3>
                                <div class="date">Doručeno {$message->created->format("h:m d.m.Y")}</div>
                            </div>
                            <div class="card-content">
                                <p>{$message->text|noescape}</p>
                            </div>
                        </div>
                        <div class="avatar">
                            <img src="{$message->user->profileImage|noescape}">
                        </div>
                    </div>
                    {/foreach}
                </div>
                {form form class=>'ajax'}

                {*
                    <div class="message-modal-users no-border chips">
                        <div class="chip icon-chip">
                            <i class="material-icons">person_add</i>
                        </div>
                        {foreach $attenders as $attender}
                        <div class="chip">{$attender->name|substr:0,1}. {$attender->surname}<i class="material-icons close">close</i></div>
                        {/foreach}
                    </div>
                    *}

                    <div class="card message-editor">
                        <div class="card-content">
                            {input text class=>'materialize-textarea', id=>'new-message-area'}
                        </div>
                        <div class="card-footer">
                            <ul class="editor-options">
                                <li>
                                    <a href="" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Přiložit soubor">
                                        <i class="material-icons">attach_file</i>
                                    </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a href="" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Tučné">
                                        <i class="material-icons">format_bold</i>
                                    </a>
                                </li>
                                <li>
                                    <a href="" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Kurzíva">
                                        <i class="material-icons">format_italic</i>
                                    </a>
                                </li>
                                <li>
                                    <a href="" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Podtržené">
                                        <i class="material-icons">format_underlined</i>
                                    </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a href="" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Nečíslovaný seznam">
                                        <i class="material-icons">format_list_bulleted</i>
                                    </a>
                                </li>
                                <li>
                                    <a href="" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Číslovaný seznam">
                                        <i class="material-icons">format_list_numbered</i>
                                    </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a href="#add-users-to-conversation" class="tooltipped modal-trigger" data-position="bottom" data-delay="50" data-tooltip="Přidat diskutující">
                                        <i class="material-icons">person_add</i>
                                    </a>
                                </li>
                                <li>
                                    <a href="#users-in-conversation" class="tooltipped modal-trigger" data-position="bottom" data-delay="50" data-tooltip="Upravit konverzaci">
                                        <i class="material-icons">people</i>
                                    </a>
                                </li>
                            </ul>
                            <div class="flex-spacer"></div>
                            <button type="button" class="modal-action modal-close waves-effect waves-light btn-flat">Zrušit</button>
                            <button type="submit" class="waves-effect waves-light btn btn-confirm submit-message-form" >Potvrdit</button>
                        </div>
                        {*
                        <script>
                            CKEDITOR.replace( 'new-message-area', {
                                uiColor: '#FFFFFF',
                                toolbarLocation: 'bottom',
                                toolbarGroups: [
                                    {"name":"basicstyles","groups":["basicstyles"]},
                                    {"name":"paragraph","groups":["list","blocks"]}
                                ],
                                removeButtons: 'Strike,Subscript,Superscript,Anchor,Styles,Specialchar',
                                placeholder: 'some value'
                            });
                        </script>
                        *}
                    </div>
                    {/form}
                    <script>
                        $(document).ready(function () {
                            $('html,body').animate({ scrollTop: document.body.scrollHeight },"fast");
                        });
                    </script>
                    <style>
                        #cke_new-message-area {
                            border: 0px;
                        }
                        
                    </style>
                </div>
            </div>
        </div>

        <div id="add-users-to-conversation" class="modal modal-small">
            <div class="modal-content">
                <h3>Přidat diskutující</h3>
                <p>Přidejte do konverzace další uživatele</p>
                <div class="form-row input-field">
                    <input type="text" name="user" id="frm-privateMessageForm-usersForm-user" class="search-user-form">
                    <label for="frm-privateMessageForm-usersForm-user">Jméno nebo e-mail uživatele</label>
                </div>
            </div>
            <div class="modal-footer">
                <div class="flex-spacer"></div>
                <div class="form-control">
                    <button type="button" class="modal-action modal-close waves-effect waves-light btn-flat">Zrušit</button>
                    <input type="submit" class="waves-effect waves-light btn btn-confirm disabled" value="Přidat">
                </div>
            </div>
        </div>

        <div id="users-in-conversation" class="modal modal-small">
            <div class="modal-content">
                <h3>Upravit konverzaci</h3>
                <p>Tito uživatelé jsou součástí konverzace</p>
                <ul class="custom-collection">
                        <li>
                            <div class="item">
                                <div class="avatar small">
                                    <img src="https://cdn.lato.cz/users/3_petr-savelka/profile/1519691465_413.JPG">
                                </div>
                                <a href="profil-uzivatele" class="label">
                                    <span class="title truncate">Petr Šavelka</span>
                                </a>
                                <div class="flex-spacer"></div>
                                <button class="btn-flat btn-icon dropdown-trigger waves-effect waves-dark" id="user-action-button" data-target="remove1">
                                    <i class="material-icons">more_horiz</i>
                                </button>
                                <ul id='remove1' class='dropdown-content'>
                                    <li><a href="" id="add-user-classification-button" >Odebrat z konverzace</a></li>                                            
                                </ul>
                            </div>
                        </li>

                        <li>
                            <div class="item">
                                <div class="avatar small">
                                    <img src="/images/default-avatar_man.png">
                                </div>
                                <a href="profil_uzivatele" class="label">
                                    <span class="title truncate">Petr Pokusný</span>
                                </a>
                                <div class="flex-spacer"></div>
                                <button class="btn-flat btn-icon dropdown-trigger waves-effect waves-dark" id="user-action-button" data-target="remove2">
                                    <i class="material-icons">more_horiz</i>
                                </button>
                                <ul id='remove2' class='dropdown-content'>
                                    <li><a href="" id="add-user-classification-button" >Odebrat z konverzace</a></li>                                            
                                </ul>
                            </div>
                        </li>
                </ul>
            </div>
            <div class="modal-footer">
                <div class="flex-spacer"></div>
                <div class="form-control">
                    <button type="button" class="modal-action modal-close waves-effect waves-light btn-flat">Zavřít</button>
                </div>
            </div>
        </div>
    </section>